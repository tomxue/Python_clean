The 1st commit code is from link:
http://www.jbxue.com/article/2515.html